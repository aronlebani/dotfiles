#!/bin/sh

include="$HOME/.homesync"
server=backup
near="$HOME"
far=/var/bak

usage()
{
	printf "Usage: homesync [OPTION]
	
Sync data in home directory to remote server using rsync.

-h | --help	show help
-d | --dry-run	see which files will by synced
-r | --restore	restore backup to local\n"
}

dry_run()
{
	rsync -raiz --dry-run --files-from "$include" --delete \
		"$near/" "$server":"$far"
}

restore()
{
	rsync -raz "$server":"$far/" "$near"
}

backup()
{
	rsync -raz --files-from "$include" --delete "$near/" "$server:$far"
}

case "$1" in
	-h | --help		) usage ;;
	-d | --dry-run	) dry_run ;;
	-r | --restore	) restore ;;
	*				) backup ;;
esac
